import React, { useState, useRef, useEffect } from 'react';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import { faUpload } from '@fortawesome/free-solid-svg-icons';

const ProjectOverview = () => {
  const [files, setFiles] = useState([]);
  const [Ufiles, setUfiles] = useState([]);
  const fileLinksContainerRef = useRef(null);

  // Handle file upload
  const handleUpload = (files) => {
    // Simulating file upload and setting the uploaded files in the state
    const uploadedFiles = files.map(file => ({
      name: file.name,
      url: URL.createObjectURL(file)
    }));
    setUfiles(uploadedFiles);
    setFiles([]); // Clear the files after upload
  };

  // Handle file delete
  const handleDelete = (fileName) => {
    setUfiles(Ufiles.filter(file => file.name !== fileName));
  };

  // Render file preview as buttons when files are uploaded
  useEffect(() => {
    // Optionally, handle any logic for when the file container renders
    if (fileLinksContainerRef.current) {
      // Perform any DOM manipulations if needed (e.g., scroll to the file container)
    }
  }, [Ufiles]);

  return (
    <div className="flex flex-col items-start p-4">

      {/* Upload Button */}
      <button
        onClick={() => handleUpload(files)}
        className={`flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-2 rounded-lg shadow-md transition ${
          files.length === 0 && "opacity-50 cursor-not-allowed"
        }`}
        disabled={files.length === 0}
      >
        Upload
      </button>

      {/* Display list of selected files with delete button */}
      <div className="mt-4">
        <h3 className="font-bold">Selected Files:</h3>
        {files.map((file, index) => (
          <div key={index} className="mt-2 flex items-center">
            <span className="text-blue-600">{file.name}</span>
            <button
              onClick={() => setFiles(files.filter((_, i) => i !== index))}
              className="ml-2 text-red-500 hover:text-red-700"
            >
              ✖
            </button>
          </div>
        ))}
      </div>

      {/* Display list of uploaded files with delete button */}
      <div ref={fileLinksContainerRef} className="mt-4">
        <h3 className="font-bold">Uploaded Files:</h3>
        {Ufiles.map((file, index) => (
          <div key={index} className="mt-2 flex items-center">
            {/* Render File Preview as Button */}
            <button
              onClick={() => window.open(file.url, "_blank")}
              className="text-blue-600 hover:bg-blue-100 px-4 py-2 rounded-md"
            >
              {file.name}
            </button>
            <button
              onClick={() => handleDelete(file.name)}
              className="ml-2 text-red-500 hover:text-red-700"
            >
              ✖
            </button>
          </div>
        ))}
      </div>
    </div>
  );
};

export default ProjectOverview;
